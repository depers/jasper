<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Jasper</title>
    <link href="style.css" type="text/css" rel="stylesheet"/>
    <script src="js/jquery-3.6.4.js"></script>
    <script src="js/axios.js"></script>
</head>

<body>
<header class="md-header">
    <nav class="md-grid md-grid__inner">
        <a class="md-header__button md-logo" href="">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
                <path
                        d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z"
                ></path>
                <path
                        d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z"
                        style="fill-opacity: 0.5;"
                ></path>
                <path
                        d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z"
                ></path>
                <path
                        d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z"
                        style="fill-opacity: 0.25;"
                ></path>
            </svg>
        </a>
        <div class="md-header__title">
            <div class="md-header__ellipsis">
                <div class="md-header__topic">
                    <span> Jasper</span>
                </div>
            </div>
        </div>
        <div class="md-header__source">
            <a href="" class="md-source">
                <div class="md-source__icon md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                        <!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.-->
                        <path
                                d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"
                        ></path>
                    </svg>
                </div>
                <div class="md-source__repository">depers/jasper</div>
            </a>
        </div>
    </nav>
</header>

<main class="md-main">
    <div class="md-main__inner md-grid">
        <div class="md-content">
        </div>
    </div>
</main>

<footer>
    <div class="pagination">
        <li class="page-item previous-page">
            <a class="page-link">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" style="width: 7px;">
                    <!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                    <path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 278.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/>
                </svg>
                <span>Prev</span>
            </a>
        </li>

        <li class="page-num">1/12</li>

        <li class="page-item next-page">
            <a class="page-link">
                <span>Next</span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" style="width: 7px;">
                    <!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                    <path d="M342.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L274.7 256 105.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/>
                </svg>
            </a>

        </li>
    </div>
    <div class="foot-bg">
        <p>Designed & Powerd by depers</p>
        <p>Copyright
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="width: 10px;">
                <!--! Font Awesome Pro 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                <path d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 464c-114.7 0-208-93.31-208-208S141.3 48 256 48s208 93.31 208 208S370.7 464 256 464zM255.1 176C255.1 176 255.1 176 255.1 176c21.06 0 40.92 8.312 55.83 23.38c9.375 9.344 24.53 9.5 33.97 .1562c9.406-9.344 9.469-24.53 .1562-33.97c-24-24.22-55.95-37.56-89.95-37.56c0 0 .0313 0 0 0c-33.97 0-65.95 13.34-89.95 37.56c-49.44 49.88-49.44 131 0 180.9c24 24.22 55.98 37.56 89.95 37.56c.0313 0 0 0 0 0c34 0 65.95-13.34 89.95-37.56c9.312-9.438 9.25-24.62-.1562-33.97c-9.438-9.312-24.59-9.219-33.97 .1562c-14.91 15.06-34.77 23.38-55.83 23.38c0 0 .0313 0 0 0c-21.09 0-40.95-8.312-55.89-23.38c-30.94-31.22-30.94-82.03 0-113.3C214.2 184.3 234 176 255.1 176z"/>
            </svg>
            2017-2023 Jasper
        </p>
        <a>陇ICP备17003451号-1</a>
    </div>
</footer>
</body>

<script type="text/javascript">
    const serverUrl = "";
    const frontUrl = "http://localhost:8080/front/index.html"
    $(document).ready(function(){

        const url = new URL(window.location.href);
        const page = url.searchParams.get("p");
        requestIndex(page);
    });

    function requestIndex(page) {
        console.log("page=" + page)
        if (page == "" || page == undefined) {
            page = 1;
        }

        axios({
            method: 'get',
            url: 'http://localhost:8081/index/article/list',
            params: {
                pageNum: page,
                pageSize: 10
            }
            })
            .catch(function (error) {
                console.log(error.toJSON());
            })
            .then(function (response) {
                console.log(response.data);
                console.log(response.status);
                var data = response.data.data;
                if(response.data.code == "0000") {
                    // 处理文章内容的填充
                    var articleHtml = "";
                    data.list.forEach(element => {
                        var tagStr = element.tags.join("/");
                        var jumpUrl = serverUrl + "/details.html"
                        var ht = "<article class=\"md-content__inner md-typeset\">" +
                                 "<p class=\"md-content__word_small\">" + 
                                 element.tags.join(" / ") + 
                                 "</p>" +
                                 "<a class=\"md-content__word\" " + 
                                 "href=\"" + 
                                 jumpUrl +                                
                                 "\">" +
                                 element.title + 
                                 "</a>" + 
                                 "<p class=\"md-content__word_date\">" + 
                                 element.createDate + 
                                 "</p>" +
                                 "<p class=\"md-content__desc\">" +
                                element.intro +
                                 "</p>" +
                                 "</article>"
                        articleHtml = articleHtml + ht;
                    });
                    $(".md-content").append(articleHtml);
                    
                    // 分页的展示
                    var currentPage = data.pageNum;
                    var totalPages = data.totalPage;
                    $(".page-num").text(currentPage + "/" + totalPages);

                    // 设置分页按钮属性
                    if (currentPage == 1) {
                        $(".previous-page").removeClass("page-item").addClass("page-btn-invalid");
                    }

                    if (currentPage == totalPages) {
                        $(".next-page").removeClass("page-item").addClass("page-btn-invalid");
                    }

                    // 分页的跳转
                    $(".previous-page").click(function(){
                        if(currentPage > 1) {
                            window.location.href = frontUrl + "?p=" + (currentPage - 1);
                        }
                    });
                    $(".next-page").click(function(){
                        if(currentPage < totalPages) {
                            window.location.href = frontUrl + "?p=" + (currentPage + 1);
                        }
                    });
                } else {
                    alert("系统错误，请稍后再试！")
                }
            })
    }
</script>
</html>
